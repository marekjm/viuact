<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <h1 id="socket_heading">Websockets test</h1>

        <div>
            <input type="text" id="message">
            <button id="send">send</button>
        </div>

        <div id="messages"></div>

        <script>
            (function () {
                var websocket = new WebSocket('ws://127.0.0.1:9000', 'lws-minimal-server-echo');
                websocket.onopen = function () {
                    document.getElementById('socket_heading').style.color = 'green';
                };
                websocket.onerror = function () {
                    document.getElementById('socket_heading').style.color = 'red';
                };
                websocket.onmessage = function (message) {
                    console.log(message.data);
                    var text = document.createTextNode(message.data);
                    var p = document.createElement('p');
                    p.appendChild(text);
                    document.getElementById('messages').appendChild(p);
                };

                document.getElementById('send').addEventListener('click', function () {
                    websocket.send(document.getElementById('message').value);
                });
            })();
        </script>
    </body>
</html>
